<div class="mb-6">
  <%= link_to "&larr; Back to Users".html_safe, admin_users_path, class: "text-sm text-blue-600 hover:text-blue-800" %>
</div>

<div class="flex justify-between items-start mb-6">
  <h2 class="text-2xl font-semibold text-gray-900"><%= @user.email %></h2>
  <div class="flex gap-2">
    <%= link_to "Edit", edit_admin_user_path(@user), class: "bg-white border border-gray-300 rounded-lg px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50" %>
    <%= link_to "Delete", admin_user_path(@user), data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this user?" }, class: "bg-red-600 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-red-700" %>
  </div>
</div>

<div class="bg-white rounded-lg border border-gray-200 p-5 mb-6">
  <dl class="grid grid-cols-2 gap-4">
    <div>
      <dt class="text-sm font-medium text-gray-500">Plan</dt>
      <dd class="mt-1 text-sm text-gray-900 capitalize"><%= @user.plan %></dd>
    </div>
    <div>
      <dt class="text-sm font-medium text-gray-500">Plan Expires At</dt>
      <dd class="mt-1 text-sm text-gray-900">
        <% if @user.plan_expires_at.present? %>
          <%= @user.plan_expires_at.strftime("%b %d, %Y at %H:%M") %>
          <% if @user.plan_expired? %>
            <span class="ml-1 text-xs text-red-600 font-medium">Expired</span>
          <% end %>
        <% else %>
          <span class="text-gray-400">No expiration</span>
        <% end %>
      </dd>
    </div>
    <div>
      <dt class="text-sm font-medium text-gray-500">Provider</dt>
      <dd class="mt-1 text-sm text-gray-900"><%= @user.provider.presence || "Email" %></dd>
    </div>
    <div>
      <dt class="text-sm font-medium text-gray-500">Stripe Customer</dt>
      <dd class="mt-1 text-sm text-gray-900"><%= @user.stripe_customer_id.presence || "â€”" %></dd>
    </div>
    <div>
      <dt class="text-sm font-medium text-gray-500">Created</dt>
      <dd class="mt-1 text-sm text-gray-900"><%= @user.created_at.strftime("%b %d, %Y at %H:%M") %></dd>
    </div>
  </dl>
</div>

<h3 class="text-lg font-medium text-gray-900 mb-3">Projects (<%= @projects.size %>)</h3>
<% if @projects.any? %>
  <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
          <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase">Sheet Size</th>
          <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
          <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase">Created</th>
          <th class="px-5 py-3"></th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
        <% @projects.each do |project| %>
          <tr class="hover:bg-gray-50">
            <td class="px-5 py-3 text-sm text-gray-900"><%= project.name.presence || "Untitled" %></td>
            <td class="px-5 py-3 text-sm text-gray-500"><%= project.sheet_width %> x <%= project.sheet_length %></td>
            <td class="px-5 py-3 text-sm">
              <% if project.archived? %>
                <span class="text-gray-400">Archived</span>
              <% else %>
                <span class="text-green-600">Active</span>
              <% end %>
            </td>
            <td class="px-5 py-3 text-sm text-gray-500"><%= project.created_at.strftime("%b %d, %Y") %></td>
            <td class="px-5 py-3 text-right">
              <%= link_to "View", admin_project_path(project), class: "text-sm text-blue-600 hover:text-blue-800" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <div class="bg-white rounded-lg border border-gray-200 p-8 text-center text-sm text-gray-500">No projects.</div>
<% end %>
